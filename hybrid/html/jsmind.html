<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>拓扑图</title>
		<script type="text/javascript" src="https://js.cdn.aliyun.dcloud.net.cn/dev/uni-app/uni.webview.1.5.2.js"></script>
		<link rel="stylesheet" href="./css/jsmind.css">
		<style>
			html {
				width: 100%;
				height: 600px;
			}

			body {
				margin: 0;
				height: 100%;
			}

			#jsmind_container {
				width: 100vw;
				height: 100%;
				background: #f4f4f4;
			}
		</style>
	</head>

	<body>
		<div id="jsmind_container"></div>
		<script src="./js/jsmind.js"></script>
		<script src="./js/jsmind.draggable.js"></script>
		<script src="./js/ajax.js"></script>
		<script>
			function getQuery(name) {
			    // 正则：[找寻'&' + 'url参数名字' = '值' + '&']（'&'可以不存在）
			    let reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
			    let r = window.location.search.substr(1).match(reg);
			    if(r != null) {
			        // 对参数值进行解码
			        return unescape(r[2]);
			    }
			    return null;
			}
			var mind = {
				meta: {
					name: 'demo',
					author: 'hizzgdev@163.com',
					version: '0.2'
				},
				format: 'node_array',
				data: [{
						id: 'root',
						isroot: true,
						topic: 'jsMind'
					},

					{
						id: 'sub1',
						parentid: 'root',
						topic: 'sub1',
						'background-color': '#0000ff'
					},
					{
						id: 'sub4',
						parentid: 'root',
						topic: 'sub4',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub5',
						parentid: 'root',
						topic: 'sub5',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub6',
						parentid: 'root',
						topic: 'sub6',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub7',
						parentid: 'root',
						topic: 'sub7',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub8',
						parentid: 'root',
						topic: 'sub8',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub9',
						parentid: 'root',
						topic: 'sub9',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub10',
						parentid: 'root',
						topic: 'sub10',
						'background-color': '#0000ff',
						direction:"left"
					},
					{
						id: 'sub11',
						parentid: 'sub1',
						topic: 'sub11'
					},
					{
						id: 'sub12',
						parentid: 'sub1',
						topic: 'sub12'
					},
					{
						id: 'sub13',
						parentid: 'sub1',
						topic: 'sub13'
					},

					{
						id: 'sub2',
						parentid: 'root',
						topic: 'sub2'
					},
					{
						id: 'sub21',
						parentid: 'sub2',
						topic: 'sub21'
					},
					{
						id: 'sub22',
						parentid: 'sub2',
						topic: 'sub22',
						'foreground-color': '#33ff33'
					},

					{
						id: 'sub3',
						parentid: 'root',
						topic: 'sub3'
					}
				]
			};
			var options = {
				container: 'jsmind_container',
				editable: true,
				theme: 'primary'
			};
			window.jm = jsMind.show(options, mind);

			jm.add_node('sub2', 'sub23', 'new node', {
				'background-color': 'red'
			});
			jm.set_node_color('sub21', 'green', '#ccc');
			document.addEventListener('UniAppJSBridgeReady', function() {
				uni.postMessage({
					data: {
						action: 'message'
					}
				});
				uni.getEnv(function(res) {
					console.log('当前环境：' + JSON.stringify(res));
					console.log(getQuery('data'))
				});
			});
		</script>
	</body>

</html>
